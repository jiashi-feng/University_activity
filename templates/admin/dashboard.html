<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理员审批 - 高校活动管理系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card {
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
        }
        .status-badge {
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-approved {
            background-color: #d1edff;
            color: #0c5460;
        }
        .status-rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        .btn-approve {
            background: linear-gradient(45deg, #28a745, #20c997);
            border: none;
            color: white;
        }
        .btn-reject {
            background: linear-gradient(45deg, #dc3545, #fd7e14);
            border: none;
            color: white;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
        }
        .tab-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        .nav-tabs .nav-link {
            border: none;
            color: #666;
            font-weight: 500;
        }
        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        .activity-details {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .approval-actions {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-university me-2"></i>高校活动管理系统
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-tasks me-1"></i>审批管理</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-map-marker-alt me-1"></i>场地管理</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-chart-bar me-1"></i>数据统计</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>管理员
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>设置</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>退出登录</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 统计卡片 -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-clock fa-2x mb-2"></i>
                        <h3 class="mb-0">8</h3>
                        <p class="mb-0">待审批活动</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-check-circle fa-2x mb-2"></i>
                        <h3 class="mb-0">25</h3>
                        <p class="mb-0">已通过</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-times-circle fa-2x mb-2"></i>
                        <h3 class="mb-0">3</h3>
                        <p class="mb-0">已拒绝</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-building fa-2x mb-2"></i>
                        <h3 class="mb-0">12</h3>
                        <p class="mb-0">可用场地</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 审批标签页 -->
        <div class="card">
            <div class="card-header bg-white">
                <ul class="nav nav-tabs card-header-tabs" id="approvalTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button" role="tab">
                            <i class="fas fa-hourglass-half me-2"></i>待审批 (8)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="approved-tab" data-bs-toggle="tab" data-bs-target="#approved" type="button" role="tab">
                            <i class="fas fa-check-circle me-2"></i>已通过 (25)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="rejected-tab" data-bs-toggle="tab" data-bs-target="#rejected" type="button" role="tab">
                            <i class="fas fa-times-circle me-2"></i>已拒绝 (3)
                        </button>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content" id="approvalTabsContent">
                    <!-- 待审批活动 -->
                    <div class="tab-pane fade show active" id="pending" role="tabpanel">
                        <div class="row">
                            <!-- 活动申请卡片 1 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-music me-2"></i>校园音乐节</h6>
                                        <span class="status-badge status-pending">待审批</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="activity-details">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 张三<br>
                                                    <strong>活动时间：</strong> 2025-08-15<br>
                                                    <strong>预计参与人数：</strong> 200人
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>申请场地：</strong> 大礼堂<br>
                                                    <strong>申请资金：</strong> ¥5000<br>
                                                    <strong>申请时间：</strong> 2025-07-10
                                                </div>
                                            </div>
                                        </div>
                                        <div class="approval-actions">
                                            <div class="mb-3">
                                                <label class="form-label">审批意见</label>
                                                <textarea class="form-control" rows="3" placeholder="请填写审批意见..."></textarea>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">分配场地</label>
                                                <select class="form-select">
                                                    <option value="">请选择场地</option>
                                                    <option value="hall">大礼堂</option>
                                                    <option value="auditorium">音乐厅</option>
                                                    <option value="square">中心广场</option>
                                                </select>
                                            </div>
                                            <div class="d-flex gap-2">
                                                <button class="btn btn-approve flex-fill" onclick="approveActivity(1)">
                                                    <i class="fas fa-check me-1"></i>通过
                                                </button>
                                                <button class="btn btn-reject flex-fill" onclick="rejectActivity(1)">
                                                    <i class="fas fa-times me-1"></i>拒绝
                                                </button>
                                                <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#activityDetailModal">
                                                    <i class="fas fa-eye"></i>详情
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 活动申请卡片 2 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-running me-2"></i>校园马拉松</h6>
                                        <span class="status-badge status-pending">待审批</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="activity-details">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 李四<br>
                                                    <strong>活动时间：</strong> 2025-08-20<br>
                                                    <strong>预计参与人数：</strong> 150人
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>申请场地：</strong> 操场<br>
                                                    <strong>申请资金：</strong> ¥3000<br>
                                                    <strong>申请时间：</strong> 2025-07-09
                                                </div>
                                            </div>
                                        </div>
                                        <div class="approval-actions">
                                            <div class="mb-3">
                                                <label class="form-label">审批意见</label>
                                                <textarea class="form-control" rows="3" placeholder="请填写审批意见..."></textarea>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">分配场地</label>
                                                <select class="form-select">
                                                    <option value="">请选择场地</option>
                                                    <option value="playground">操场</option>
                                                    <option value="stadium">体育馆</option>
                                                    <option value="track">田径场</option>
                                                </select>
                                            </div>
                                            <div class="d-flex gap-2">
                                                <button class="btn btn-approve flex-fill" onclick="approveActivity(2)">
                                                    <i class="fas fa-check me-1"></i>通过
                                                </button>
                                                <button class="btn btn-reject flex-fill" onclick="rejectActivity(2)">
                                                    <i class="fas fa-times me-1"></i>拒绝
                                                </button>
                                                <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#activityDetailModal">
                                                    <i class="fas fa-eye"></i>详情
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 已通过活动 -->
                    <div class="tab-pane fade" id="approved" role="tabpanel">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>活动名称</th>
                                        <th>组织者</th>
                                        <th>活动时间</th>
                                        <th>分配场地</th>
                                        <th>申请资金</th>
                                        <th>审批时间</th>
                                        <th>状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><i class="fas fa-book me-2"></i>读书分享会</td>
                                        <td>王五</td>
                                        <td>2025-07-20</td>
                                        <td>图书馆报告厅</td>
                                        <td>¥800</td>
                                        <td>2025-07-08</td>
                                        <td><span class="status-badge status-approved">已通过</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#activityDetailModal">
                                                <i class="fas fa-eye"></i>详情
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><i class="fas fa-paint-brush me-2"></i>艺术展览</td>
                                        <td>赵六</td>
                                        <td>2025-07-25</td>
                                        <td>艺术楼展厅</td>
                                        <td>¥2000</td>
                                        <td>2025-07-07</td>
                                        <td><span class="status-badge status-approved">已通过</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#activityDetailModal">
                                                <i class="fas fa-eye"></i>详情
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 已拒绝活动 -->
                    <div class="tab-pane fade" id="rejected" role="tabpanel">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>活动名称</th>
                                        <th>组织者</th>
                                        <th>活动时间</th>
                                        <th>申请资金</th>
                                        <th>拒绝原因</th>
                                        <th>拒绝时间</th>
                                        <th>状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><i class="fas fa-microphone me-2"></i>深夜音乐会</td>
                                        <td>孙七</td>
                                        <td>2025-07-30</td>
                                        <td>¥8000</td>
                                        <td>时间不合适，影响学生休息</td>
                                        <td>2025-07-06</td>
                                        <td><span class="status-badge status-rejected">已拒绝</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#activityDetailModal">
                                                <i class="fas fa-eye"></i>详情
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 活动详情模态框 -->
    <div class="modal fade" id="activityDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">活动详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>基本信息</h6>
                            <table class="table table-borderless table-sm">
                                <tr><td><strong>活动名称：</strong></td><td>校园音乐节</td></tr>
                                <tr><td><strong>组织者：</strong></td><td>张三</td></tr>
                                <tr><td><strong>联系方式：</strong></td><td>13888888888</td></tr>
                                <tr><td><strong>活动时间：</strong></td><td>2025-08-15 19:00-21:00</td></tr>
                                <tr><td><strong>预计参与人数：</strong></td><td>200人</td></tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6>资源申请</h6>
                            <table class="table table-borderless table-sm">
                                <tr><td><strong>申请场地：</strong></td><td>大礼堂</td></tr>
                                <tr><td><strong>申请资金：</strong></td><td>¥5000</td></tr>
                                <tr><td><strong>申请时间：</strong></td><td>2025-07-10</td></tr>
                                <tr><td><strong>当前状态：</strong></td><td><span class="status-badge status-pending">待审批</span></td></tr>
                            </table>
                        </div>
                    </div>
                    <div class="mt-3">
                        <h6>活动描述</h6>
                        <p class="text-muted">
                            校园音乐节是一个展示学生音乐才能的平台，邀请校内外音乐爱好者参与表演，
                            增进校园文化氛围，丰富学生业余生活。活动将包含民谣、摇滚、古典音乐等多种风格的表演。
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // 审批活动函数
        function approveActivity(activityId) {
            if (confirm('确定要通过这个活动申请吗？')) {
                // 这里应该发送AJAX请求到后端
                fetch('/admin/approve_activity', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        activity_id: activityId,
                        action: 'approve',
                        comment: document.querySelector('textarea').value,
                        venue: document.querySelector('select').value
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('活动已通过审批！');
                        location.reload();
                    } else {
                        alert('审批失败：' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('网络错误，请稍后重试');
                });
            }
        }

        // 拒绝活动函数
        function rejectActivity(activityId) {
            if (confirm('确定要拒绝这个活动申请吗？')) {
                // 这里应该发送AJAX请求到后端
                fetch('/admin/approve_activity', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        activity_id: activityId,
                        action: 'reject',
                        comment: document.querySelector('textarea').value
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('活动已拒绝！');
                        location.reload();
                    } else {
                        alert('操作失败：' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('网络错误，请稍后重试');
                });
            }
        }

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 可以在这里加载实时数据
            console.log('管理员审批页面加载完成');
        });
    </script>
</body>
</html>