<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>资金拨款管理 - 高校活动管理系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        .navbar {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
        }
        .card {
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
        }
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-approved {
            background-color: #d1edff;
            color: #0c5460;
        }
        .status-funded {
            background-color: #d4edda;
            color: #155724;
        }
        .status-rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        .btn-fund {
            background: linear-gradient(45deg, #4CAF50, #66BB6A);
            border: none;
            color: white;
        }
        .btn-partial {
            background: linear-gradient(45deg, #FF9800, #FFB74D);
            border: none;
            color: white;
        }
        .btn-reject {
            background: linear-gradient(45deg, #F44336, #EF5350);
            border: none;
            color: white;
        }
        .stat-card {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            border-radius: 15px;
        }
        .budget-card {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            border-radius: 15px;
        }
        .tab-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        .nav-tabs .nav-link {
            border: none;
            color: #666;
            font-weight: 500;
        }
        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        .funding-details {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .funding-actions {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }
        .score-input {
            background: #e8f5e8;
            border: 2px solid #4CAF50;
        }
        .amount-input {
            background: #e3f2fd;
            border: 2px solid #2196F3;
        }
        .progress-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .quarterly-summary {
            background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-university me-2"></i>高校活动管理系统
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-money-check-alt me-1"></i>资金拨款</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-trophy me-1"></i>季度奖励</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-chart-line me-1"></i>统计报告</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-tie me-1"></i>张老师
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>设置</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>退出登录</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 季度预算概览 -->
        <div class="quarterly-summary">
            <div class="row">
                <div class="col-md-8">
                    <h4><i class="fas fa-calendar-alt me-2"></i>2025年第三季度预算概览</h4>
                    <div class="row mt-3">
                        <div class="col-md-4">
                            <h6>总预算</h6>
                            <h3>¥50,000</h3>
                        </div>
                        <div class="col-md-4">
                            <h6>已拨款</h6>
                            <h3>¥32,500</h3>
                        </div>
                        <div class="col-md-4">
                            <h6>剩余预算</h6>
                            <h3>¥17,500</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="text-center">
                        <canvas id="budgetChart" width="150" height="150"></canvas>
                        <p class="mt-2 mb-0">预算使用率: 65%</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 统计卡片 -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-hourglass-half fa-2x mb-2"></i>
                        <h3 class="mb-0">5</h3>
                        <p class="mb-0">待拨款活动</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card budget-card">
                    <div class="card-body text-center">
                        <i class="fas fa-coins fa-2x mb-2"></i>
                        <h3 class="mb-0">¥8,500</h3>
                        <p class="mb-0">待拨款总额</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stat-card">
                    <div class="card-body text-center">
                        <i class="fas fa-check-circle fa-2x mb-2"></i>
                        <h3 class="mb-0">18</h3>
                        <p class="mb-0">已完成拨款</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card budget-card">
                    <div class="card-body text-center">
                        <i class="fas fa-star fa-2x mb-2"></i>
                        <h3 class="mb-0">4.6</h3>
                        <p class="mb-0">平均活动评分</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 拨款管理标签页 -->
        <div class="card">
            <div class="card-header bg-white">
                <ul class="nav nav-tabs card-header-tabs" id="fundingTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="pending-funding-tab" data-bs-toggle="tab" data-bs-target="#pending-funding" type="button" role="tab">
                            <i class="fas fa-hourglass-half me-2"></i>待拨款 (5)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="completed-funding-tab" data-bs-toggle="tab" data-bs-target="#completed-funding" type="button" role="tab">
                            <i class="fas fa-check-circle me-2"></i>已拨款 (18)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="scoring-tab" data-bs-toggle="tab" data-bs-target="#scoring" type="button" role="tab">
                            <i class="fas fa-star me-2"></i>活动评分 (12)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="rewards-tab" data-bs-toggle="tab" data-bs-target="#rewards" type="button" role="tab">
                            <i class="fas fa-trophy me-2"></i>季度奖励
                        </button>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content" id="fundingTabsContent">
                    <!-- 待拨款活动 -->
                    <div class="tab-pane fade show active" id="pending-funding" role="tabpanel">
                        <div class="row">
                            <!-- 拨款申请卡片 1 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-music me-2"></i>校园音乐节</h6>
                                        <span class="status-badge status-approved">已通过审批</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="funding-details">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 张三<br>
                                                    <strong>活动时间：</strong> 2025-08-15<br>
                                                    <strong>参与人数：</strong> 200人<br>
                                                    <strong>分配场地：</strong> 大礼堂
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>申请资金：</strong> ¥5,000<br>
                                                    <strong>审批时间：</strong> 2025-07-10<br>
                                                    <strong>活动状态：</strong> 筹备中<br>
                                                    <strong>当前评分：</strong> 待评分
                                                </div>
                                            </div>
                                        </div>
                                        <div class="funding-actions">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label class="form-label">拨款金额</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">¥</span>
                                                        <input type="number" class="form-control amount-input" value="5000" max="5000">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">拨款比例</label>
                                                    <select class="form-select">
                                                        <option value="100">100% - 全额拨款</option>
                                                        <option value="80">80% - 部分拨款</option>
                                                        <option value="60">60% - 部分拨款</option>
                                                        <option value="0">0% - 拒绝拨款</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <label class="form-label">拨款说明</label>
                                                <textarea class="form-control" rows="2" placeholder="请填写拨款说明或建议..."></textarea>
                                            </div>
                                            <div class="d-flex gap-2 mt-3">
                                                <button class="btn btn-fund flex-fill" onclick="approveFunding(1, 'full')">
                                                    <i class="fas fa-check me-1"></i>全额拨款
                                                </button>
                                                <button class="btn btn-partial flex-fill" onclick="approveFunding(1, 'partial')">
                                                    <i class="fas fa-adjust me-1"></i>部分拨款
                                                </button>
                                                <button class="btn btn-reject flex-fill" onclick="rejectFunding(1)">
                                                    <i class="fas fa-times me-1"></i>拒绝拨款
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 拨款申请卡片 2 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-running me-2"></i>校园马拉松</h6>
                                        <span class="status-badge status-approved">已通过审批</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="funding-details">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 李四<br>
                                                    <strong>活动时间：</strong> 2025-08-20<br>
                                                    <strong>参与人数：</strong> 150人<br>
                                                    <strong>分配场地：</strong> 操场
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>申请资金：</strong> ¥3,000<br>
                                                    <strong>审批时间：</strong> 2025-07-09<br>
                                                    <strong>活动状态：</strong> 筹备中<br>
                                                    <strong>当前评分：</strong> 待评分
                                                </div>
                                            </div>
                                        </div>
                                        <div class="funding-actions">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label class="form-label">拨款金额</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">¥</span>
                                                        <input type="number" class="form-control amount-input" value="3000" max="3000">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">拨款比例</label>
                                                    <select class="form-select">
                                                        <option value="100">100% - 全额拨款</option>
                                                        <option value="80">80% - 部分拨款</option>
                                                        <option value="60">60% - 部分拨款</option>
                                                        <option value="0">0% - 拒绝拨款</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <label class="form-label">拨款说明</label>
                                                <textarea class="form-control" rows="2" placeholder="请填写拨款说明或建议..."></textarea>
                                            </div>
                                            <div class="d-flex gap-2 mt-3">
                                                <button class="btn btn-fund flex-fill" onclick="approveFunding(2, 'full')">
                                                    <i class="fas fa-check me-1"></i>全额拨款
                                                </button>
                                                <button class="btn btn-partial flex-fill" onclick="approveFunding(2, 'partial')">
                                                    <i class="fas fa-adjust me-1"></i>部分拨款
                                                </button>
                                                <button class="btn btn-reject flex-fill" onclick="rejectFunding(2)">
                                                    <i class="fas fa-times me-1"></i>拒绝拨款
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 已拨款活动 -->
                    <div class="tab-pane fade" id="completed-funding" role="tabpanel">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>活动名称</th>
                                        <th>组织者</th>
                                        <th>活动时间</th>
                                        <th>申请金额</th>
                                        <th>拨款金额</th>
                                        <th>拨款比例</th>
                                        <th>拨款时间</th>
                                        <th>状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><i class="fas fa-book me-2"></i>读书分享会</td>
                                        <td>王五</td>
                                        <td>2025-07-20</td>
                                        <td>¥800</td>
                                        <td>¥800</td>
                                        <td><span class="badge bg-success">100%</span></td>
                                        <td>2025-07-08</td>
                                        <td><span class="status-badge status-funded">已拨款</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="viewFundingDetails(1)">
                                                <i class="fas fa-eye"></i>详情
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><i class="fas fa-paint-brush me-2"></i>艺术展览</td>
                                        <td>赵六</td>
                                        <td>2025-07-25</td>
                                        <td>¥2000</td>
                                        <td>¥1600</td>
                                        <td><span class="badge bg-warning">80%</span></td>
                                        <td>2025-07-07</td>
                                        <td><span class="status-badge status-funded">已拨款</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="viewFundingDetails(2)">
                                                <i class="fas fa-eye"></i>详情
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 活动评分 -->
                    <div class="tab-pane fade" id="scoring" role="tabpanel">
                        <div class="row">
                            <!-- 评分卡片 1 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-book me-2"></i>读书分享会</h6>
                                        <span class="status-badge status-funded">已完成</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="progress-container">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 王五<br>
                                                    <strong>活动时间：</strong> 2025-07-20<br>
                                                    <strong>参与人数：</strong> 45人<br>
                                                    <strong>拨款金额：</strong> ¥800
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>活动完成度：</strong> 100%<br>
                                                    <strong>参与满意度：</strong> 4.8/5.0<br>
                                                    <strong>预算执行率：</strong> 95%<br>
                                                    <strong>当前评分：</strong> 待评分
                                                </div>
                                            </div>
                                        </div>
                                        <div class="funding-actions">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label class="form-label">组织能力评分</label>
                                                    <input type="number" class="form-control score-input" min="0" max="10" step="0.1" placeholder="0-10分">
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">活动质量评分</label>
                                                    <input type="number" class="form-control score-input" min="0" max="10" step="0.1" placeholder="0-10分">
                                                </div>
                                            </div>
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">创新性评分</label>
                                                    <input type="number" class="form-control score-input" min="0" max="10" step="0.1" placeholder="0-10分">
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">影响力评分</label>
                                                    <input type="number" class="form-control score-input" min="0" max="10" step="0.1" placeholder="0-10分">
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <label class="form-label">评分说明</label>
                                                <textarea class="form-control" rows="2" placeholder="请填写评分说明..."></textarea>
                                            </div>
                                            <div class="d-flex gap-2 mt-3">
                                                <button class="btn btn-fund flex-fill" onclick="submitScore(1)">
                                                    <i class="fas fa-star me-1"></i>提交评分
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="viewActivityReport(1)">
                                                    <i class="fas fa-file-alt"></i>查看报告
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 评分卡片 2 -->
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0"><i class="fas fa-paint-brush me-2"></i>艺术展览</h6>
                                        <span class="status-badge status-funded">已完成</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="progress-container">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <strong>组织者：</strong> 赵六<br>
                                                    <strong>活动时间：</strong> 2025-07-25<br>
                                                    <strong>参与人数：</strong> 120人<br>
                                                    <strong>拨款金额：</strong> ¥1600
                                                </div>
                                                <div class="col-sm-6">
                                                    <strong>活动完成度：</strong> 100%<br>
                                                    <strong>参与满意度：</strong> 4.5/5.0<br>
                                                    <strong>预算执行率：</strong> 88%<br>
                                                    <strong>当前评分：</strong> 8.5分
                                                </div>
                                            </div>
                                        </div>
                                        <div class="funding-actions">
                                            <div class="alert alert-success">
                                                <i class="fas fa-check-circle me-2"></i>
                                                <strong>已完成评分</strong> - 综合得分：8.5/10
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <small class="text-muted">组织能力：8.0分</small><br>
                                                    <small class="text-muted">活动质量：9.0分</small>
                                                </div>
                                                <div class="col-md-6">
                                                    <small class="text-muted">创新性：8.5分</small><br>
                                                    <small class="text-muted">影响力：8.5分</small>
                                                </div>
                                            </div>
                                            <div class="d-flex gap-2 mt-3">
                                                <button class="btn btn-outline-secondary flex-fill" onclick="editScore(2)">
                                                    <i class="fas fa-edit me-1"></i>修改评分
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="viewActivityReport(2)">
                                                    <i class="fas fa-file-alt"></i>查看报告
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 季度奖励 -->
                    <div class="tab-pane fade" id="rewards" role="tabpanel">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="fas fa-trophy me-2"></i>季度奖励统计</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th>排名</th>
                                                        <th>组织者</th>
                                                        <th>活动数量</th>
                                                        <th>平均评分</th>
                                                        <th>参与总人数</th>
                                                        <th>奖励等级</th>
                                                        <th>奖励金额</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="table-warning">
                                                        <td><i class="fas fa-crown text-warning"></i> 1</td>
                                                        <td>张三</td>
                                                        <td>3</td>
                                                        <td>9.2</td>
                                                        <td>456</td>
                                                        <td><span class="badge bg-warning">金奖</span></td>
                                                        <td>¥2000</td>
                                                    </tr>
                                                    <tr class="table-secondary">
                                                        <td><i class="fas fa-medal text-secondary"></i> 2</td>
                                                        <td>李四</td>
                                                        <td>2</td>
                                                        <td>8.8</td>
                                                        <td>324</td>
                                                        <td><span class="badge bg-secondary">银奖</span></td>
                                                        <td>¥1500</td>
                                                    </tr>
                                                    <tr class="table-warning">
                                                        <td><i class="fas fa-award text-warning"></i> 3</td>
                                                        <td>王五</td>
                                                        <td>4</td>
                                                        <td>8.5</td>
                                                        <td>298</td>
                                                        <td><span class="badge bg-warning">铜奖</span></td>
                                                        <td>¥1000</td>
                                                    </tr>
                                                    <tr>
                                                        <td>4</td>
                                                        <td>赵六</td>
                                                        <td>2</td>
                                                        <td>8.2</td>
                                                        <td>156</td>
                                                        <td><span class="badge bg-success">优秀</span></td>
                                                        <td>¥500</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="d-flex justify-content-between mt-3">
                                            <button class="btn btn-fund" onclick="generateRewardReport()">
                                                <i class="fas fa-file-export me-1"></i>生成奖励报告
                                            </button>
                                            <button class="btn btn-outline-secondary" onclick="distributeRewards()">
                                                <i class="fas fa-gift me-1"></i>发放奖励
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="fas fa-chart-pie me-2"></i>奖励分布</h6>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="rewardChart" width="200" height="200"></canvas>
                                        <div class="mt-3">
                                            <div class="d-flex justify-content-between">
                                                <span>总奖励金额：</span>
                                                <strong>¥5,000</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>获奖人数：</span>
                                                <strong>4人</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>平均奖励：</span>
                                                <strong>¥1,250</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <script>
        // 拨款函数
        function approveFunding(activityId, type) {
            const action = type === 'full' ? '全额拨款' : '部分拨款';
            if (confirm(`确定要${action}吗？`)) {
                // 这里应该发送AJAX请求到后端
                fetch('/teacher/approve_funding', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        activity_id: activityId,
                        type: type,
                        amount: document.querySelector('.amount-input').value,
                        comment: document.querySelector('textarea').value
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('拨款成功！');
                        location.reload();
                    } else {
                        alert('拨款失败：' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('网络错误，请稍后重试');
                });
            }
        }

        // 拒绝拨款函数
        function rejectFunding(activityId) {
            if (confirm('确定要拒绝拨款吗？')) {
                // 这里应该发送AJAX请求到后端
                fetch('/teacher/reject_funding', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        activity_id: activityId,
                        comment: document.querySelector('textarea').value
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('已拒绝拨款！');
                        location.reload();
                    } else {
                        alert('操作失败：' + data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('网络错误，请稍后重试');
                });
            }
        }

        // 提交评分函数
        function submitScore(activityId) {
            // 这里应该发送AJAX请求到后端
            alert('评分已提交！');
        }

        // 查看活动报告
        function viewActivityReport(activityId) {
            // 这里应该跳转到报告页面
            alert('查看活动报告：' + activityId);
        }

        // 修改评分
        function editScore(activityId) {
            // 这里应该打开评分编辑界面
            alert('修改评分：' + activityId);
        }

        // 查看拨款详情
        function viewFundingDetails(activityId) {
            // 这里应该打开详情界面
            alert('查看拨款详情：' + activityId);
        }

        // 生成奖励报告
        function generateRewardReport() {
            // 这里应该生成报告
            alert('奖励报告已生成！');
        }

        // 发放奖励
        function distributeRewards() {
            // 这里应该发放奖励
            alert('奖励已发放！');
        }

        // 预算图表
        window.onload = function() {
            const budgetCtx = document.getElementById('budgetChart').getContext('2d');
            const budgetChart = new Chart(budgetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['已使用', '剩余'],
                    datasets: [{
                        data: [65, 35],
                        backgroundColor: ['#2196F3', '#E0E0E0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    cutout: '70%',
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            const rewardCtx = document.getElementById('rewardChart').getContext('2d');
            const rewardChart = new Chart(rewardCtx, {
                type: 'pie',
                data: {
                    labels: ['金奖', '银奖', '铜奖', '优秀'],
                    datasets: [{
                        data: [2000, 1500, 1000, 500],
                        backgroundColor: ['#FFC107', '#9E9E9E', '#CD7F32', '#4CAF50'],
                        borderWidth: 0
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        };
    </script>
</body>
</html>